// tslint:disable-next-line:max-line-length
export const worker = `!function(){"use strict";var e=function(e){var t=new ArrayBuffer(e);return{arrayBuffer:t,dataView:new DataView(t)}},t=function(t,r,n){var a=e(14),i=a.arrayBuffer,s=a.dataView;return s.setUint32(0,1297377380),s.setUint32(4,6),s.setUint16(8,r),s.setUint16(10,n.length),s.setUint16(12,t),i},r=function(e){var t=new ArrayBuffer(e);return{arrayBuffer:t,dataView:new DataView(t)}},n=function(e){var t=e.reduce(function(e,t){return e+t.byteLength},0);return e.reduce(function(e,t){var r=e[0],n=e[1];return n.set(new Uint8Array(t),r),[r+t.byteLength,n]},[0,new Uint8Array(t)])[1].buffer},a=function(e){for(var t=Math.max(1,Math.floor(Math.log(e)/Math.log(2)/7)+1),n=r(t),a=n.arrayBuffer,i=n.dataView,s=t-1,f=0;f<s;f+=1)i.setUint8(f,e>>7|128),e&=127;return i.setUint8(t-1,e),a},i=function(e){if("channelPrefix"in e){var t=r(4),i=t.arrayBuffer;return(v=t.dataView).setUint8(0,255),v.setUint8(1,32),v.setUint8(2,1),v.setUint8(3,e.channelPrefix),i}if("controlChange"in e){var s=r(3),i=s.arrayBuffer;return(v=s.dataView).setUint8(0,176|15&e.channel),v.setUint8(1,e.controlChange.type),v.setUint8(2,e.controlChange.value),i}if("endOfTrack"in e){var f=r(3),i=f.arrayBuffer;return(v=f.dataView).setUint8(0,255),v.setUint8(1,47),v.setUint8(2,0),i}if("keySignature"in e){var o=r(5),i=o.arrayBuffer;return(v=o.dataView).setUint8(0,255),v.setUint8(1,89),v.setUint8(2,2),v.setUint8(3,e.keySignature.key),v.setUint8(4,e.keySignature.scale),i}if("midiPort"in e){var u=r(4),i=u.arrayBuffer;return(v=u.dataView).setUint8(0,255),v.setUint8(1,33),v.setUint8(2,1),v.setUint8(3,e.midiPort),i}if("noteOff"in e){var c=r(3),i=c.arrayBuffer;return(v=c.dataView).setUint8(0,128|15&e.channel),v.setUint8(1,e.noteOff.noteNumber),v.setUint8(2,e.noteOff.velocity),i}if("noteOn"in e){var U=r(3),i=U.arrayBuffer;return(v=U.dataView).setUint8(0,144|15&e.channel),v.setUint8(1,e.noteOn.noteNumber),v.setUint8(2,e.noteOn.velocity),i}if("pitchBend"in e){var d=r(3),i=d.arrayBuffer;return(v=d.dataView).setUint8(0,224|15&e.channel),v.setUint8(1,127&e.pitchBend),v.setUint8(2,e.pitchBend>>7),i}if("programChange"in e){var y=r(2),i=y.arrayBuffer;return(v=y.dataView).setUint8(0,192|15&e.channel),v.setUint8(1,e.programChange.programNumber),i}if("setTempo"in e){var m=r(6),i=m.arrayBuffer;return(v=m.dataView).setUint8(0,255),v.setUint8(1,81),v.setUint8(2,3),v.setUint8(3,e.setTempo.microsecondsPerBeat>>16),v.setUint8(4,e.setTempo.microsecondsPerBeat>>8),v.setUint8(5,e.setTempo.microsecondsPerBeat),i}if("smpteOffset"in e){var h=r(8),i=h.arrayBuffer,v=h.dataView,l=void 0;return 24===e.smpteOffset.frameRate?l=0:25===e.smpteOffset.frameRate?l=32:29===e.smpteOffset.frameRate?l=64:30===e.smpteOffset.frameRate&&(l=96),v.setUint8(0,255),v.setUint8(1,84),v.setUint8(2,5),v.setUint8(3,e.smpteOffset.hour|l),v.setUint8(4,e.smpteOffset.minutes),v.setUint8(5,e.smpteOffset.seconds),v.setUint8(6,e.smpteOffset.frame),v.setUint8(7,e.smpteOffset.subFrame),i}if("sysex"in e){var w=r(1),i=w.arrayBuffer;(v=w.dataView).setUint8(0,240);for(var g=e.sysex.length/2,p=a(g),B=r(g),V=B.arrayBuffer,b=B.dataView,O=0;O<e.sysex.length;O+=2)b.setUint8(O/2,parseInt(e.sysex.slice(O,O+2),16));return n([i,p,V])}if("timeSignature"in e){for(var x=r(7),i=x.arrayBuffer,v=x.dataView,S=e.timeSignature.denominator,A=0;S>1;)S/=2,A+=1;return v.setUint8(0,255),v.setUint8(1,88),v.setUint8(2,4),v.setUint8(3,e.timeSignature.numerator),v.setUint8(4,A),v.setUint8(5,e.timeSignature.metronome),v.setUint8(6,e.timeSignature.thirtyseconds),i}if("trackName"in e){var M=r(2),i=M.arrayBuffer;(v=M.dataView).setUint8(0,255),v.setUint8(1,3);var k=(new TextEncoder).encode(e.trackName).buffer,L=a(k.byteLength);return n([i,L,k])}throw new Error('Unencodable event with a delta of "'+e.delta+'".')},s=function(e){var t=e.reduce(function(e,t){return e+t.byteLength},0);return e.reduce(function(e,t){var r=e.offset,n=e.uint8Array;return n.set(new Uint8Array(t),r),{offset:r+t.byteLength,uint8Array:n}},{offset:0,uint8Array:new Uint8Array(t)}).uint8Array.buffer},f=function(t){for(var r=Math.max(1,Math.floor(Math.log(t)/Math.log(2)/7)+1),n=e(r),a=n.arrayBuffer,i=n.dataView,s=r-1,f=0;f<s;f+=1)i.setUint8(f,t>>7|128),t&=127;return i.setUint8(r-1,t),a},o=function(t){var r=e(8),n=r.arrayBuffer,a=r.dataView,o=[n],u=0;a.setUint32(0,1297379947);var c=!0,U=!1,d=void 0;try{for(var y,m=t[Symbol.iterator]();!(c=(y=m.next()).done);c=!0){var h=y.value,v=f(h.delta);try{var l=i(h);u+=v.byteLength+l.byteLength,o.push(v,l)}catch(e){if(e.message.match(/Unencodable\\smessage\\swith\\sa\\sdelta\\sof\\s[0-9]+\\./)){var w=t.indexOf(h);throw new Error("Unencodable message at index "+w+".")}throw e}}}catch(e){U=!0,d=e}finally{try{!c&&m.return&&m.return()}finally{if(U)throw d}}return a.setUint32(4,u),s(o)},u=function(e){var r=e.division,n=e.format,a=e.tracks,i=[];try{i.push(t(r,n,a))}catch(e){throw new Error("The given JSON object seems to be invalid.")}var f=!0,u=!1,c=void 0;try{for(var U,d=a[Symbol.iterator]();!(f=(U=d.next()).done);f=!0){var y=U.value;try{i.push(o(y))}catch(e){if(e.message.match(/Unencodable\\sevent\\sat\\sposition\\s[0-9]+\\./)){var m=a.indexOf(y);throw new Error(e.message.slice(0,-1)+" of the track at index "+m+".")}throw e}}}catch(e){u=!0,c=e}finally{try{!f&&d.return&&d.return()}finally{if(u)throw c}}return s(i)};addEventListener("message",function(e){var t=e.data;try{if("encode"!==t.method)throw new Error('The given method "'+t.method+'" is not supported');var r=t.id,n=t.params.midiFile,a=u(n);postMessage({error:null,id:r,result:{arrayBuffer:a}},[a])}catch(e){postMessage({error:{message:e.message},id:t.id,result:null})}})}();`;

// tslint:disable-next-line:max-line-length
export const worker = `!function(){"use strict";var t=function(t){var e=new ArrayBuffer(t);return{arrayBuffer:e,dataView:new DataView(e)}},e=function(e,r,n){var a=t(14),i=a.arrayBuffer,s=a.dataView;return s.setUint32(0,1297377380),s.setUint32(4,6),s.setUint16(8,r),s.setUint16(10,n.length),s.setUint16(12,e),i},r=function(t){return void 0!==t.channelPrefix},n=function(t){return void 0!==t.controlChange},a=function(t){return void 0!==t.endOfTrack},i=function(t){return void 0!==t.keySignature},s=function(t){return void 0!==t.setTempo},f=function(t){return void 0!==t.midiPort},o=function(t){return void 0!==t.noteOff},u=function(t){return void 0!==t.noteOn},c=function(t){return void 0!==t.pitchBend},d=function(t){return void 0!==t.programChange},U=function(t){return void 0!==t.smpteOffset},v=function(t){return void 0!==t.sysex},y=function(t){return void 0!==t.timeSignature},h=function(t){return void 0!==t.trackName},m=function(t){var e=new ArrayBuffer(t);return{arrayBuffer:e,dataView:new DataView(e)}},l=function(t){var e=t.reduce(function(t,e){return t+e.byteLength},0);return t.reduce(function(t,e){var r=t[0],n=t[1];return n.set(new Uint8Array(e),r),[r+e.byteLength,n]},[0,new Uint8Array(e)])[1].buffer},w=function(t){for(var e=Math.max(1,Math.floor(Math.log(t)/Math.log(2)/7)+1),r=m(e),n=r.arrayBuffer,a=r.dataView,i=e-1,s=t,f=0;f<i;f+=1)a.setUint8(f,s>>7|128),s&=127;return a.setUint8(e-1,s),n},g=function(t){if(r(t)){var e=m(4),g=e.arrayBuffer;return(E=e.dataView).setUint8(0,255),E.setUint8(1,32),E.setUint8(2,1),E.setUint8(3,t.channelPrefix),g}if(n(t)){var p=m(3),g=p.arrayBuffer;return(E=p.dataView).setUint8(0,176|15&t.channel),E.setUint8(1,t.controlChange.type),E.setUint8(2,t.controlChange.value),g}if(a(t)){var B=m(3),g=B.arrayBuffer;return(E=B.dataView).setUint8(0,255),E.setUint8(1,47),E.setUint8(2,0),g}if(i(t)){var V=m(5),g=V.arrayBuffer;return(E=V.dataView).setUint8(0,255),E.setUint8(1,89),E.setUint8(2,2),E.setUint8(3,t.keySignature.key),E.setUint8(4,t.keySignature.scale),g}if(f(t)){var b=m(4),g=b.arrayBuffer;return(E=b.dataView).setUint8(0,255),E.setUint8(1,33),E.setUint8(2,1),E.setUint8(3,t.midiPort),g}if(o(t)){var O=m(3),g=O.arrayBuffer;return(E=O.dataView).setUint8(0,128|15&t.channel),E.setUint8(1,t.noteOff.noteNumber),E.setUint8(2,t.noteOff.velocity),g}if(u(t)){var x=m(3),g=x.arrayBuffer;return(E=x.dataView).setUint8(0,144|15&t.channel),E.setUint8(1,t.noteOn.noteNumber),E.setUint8(2,t.noteOn.velocity),g}if(c(t)){var S=m(3),g=S.arrayBuffer;return(E=S.dataView).setUint8(0,224|15&t.channel),E.setUint8(1,127&t.pitchBend),E.setUint8(2,t.pitchBend>>7),g}if(d(t)){var A=m(2),g=A.arrayBuffer;return(E=A.dataView).setUint8(0,192|15&t.channel),E.setUint8(1,t.programChange.programNumber),g}if(s(t)){var M=m(6),g=M.arrayBuffer;return(E=M.dataView).setUint8(0,255),E.setUint8(1,81),E.setUint8(2,3),E.setUint8(3,t.setTempo.microsecondsPerBeat>>16),E.setUint8(4,t.setTempo.microsecondsPerBeat>>8),E.setUint8(5,t.setTempo.microsecondsPerBeat),g}if(U(t)){var k=m(8),g=k.arrayBuffer,E=k.dataView,L=void 0;if(24===t.smpteOffset.frameRate)L=0;else if(25===t.smpteOffset.frameRate)L=32;else if(29===t.smpteOffset.frameRate)L=64;else{if(30!==t.smpteOffset.frameRate)throw new Error;L=96}return E.setUint8(0,255),E.setUint8(1,84),E.setUint8(2,5),E.setUint8(3,t.smpteOffset.hour|L),E.setUint8(4,t.smpteOffset.minutes),E.setUint8(5,t.smpteOffset.seconds),E.setUint8(6,t.smpteOffset.frame),E.setUint8(7,t.smpteOffset.subFrame),g}if(v(t)){var T=m(1),g=T.arrayBuffer;(E=T.dataView).setUint8(0,240);for(var P=t.sysex.length/2,N=w(P),C=m(P),R=C.arrayBuffer,D=C.dataView,F=0;F<t.sysex.length;F+=2)D.setUint8(F/2,parseInt(t.sysex.slice(F,F+2),16));return l([g,N,R])}if(y(t)){for(var j=m(7),g=j.arrayBuffer,E=j.dataView,I=t.timeSignature.denominator,J=0;I>1;)I/=2,J+=1;return E.setUint8(0,255),E.setUint8(1,88),E.setUint8(2,4),E.setUint8(3,t.timeSignature.numerator),E.setUint8(4,J),E.setUint8(5,t.timeSignature.metronome),E.setUint8(6,t.timeSignature.thirtyseconds),g}if(h(t)){var q=m(2),g=q.arrayBuffer;(E=q.dataView).setUint8(0,255),E.setUint8(1,3);var z=(new TextEncoder).encode(t.trackName).buffer,G=w(z.byteLength);return l([g,G,z])}throw new Error('Unencodable event with a delta of "'+t.delta+'".')},p=function(t){var e=t.reduce(function(t,e){return t+e.byteLength},0);return t.reduce(function(t,e){var r=t.offset,n=t.uint8Array;return n.set(new Uint8Array(e),r),{offset:r+e.byteLength,uint8Array:n}},{offset:0,uint8Array:new Uint8Array(e)}).uint8Array.buffer},B=function(e){for(var r=Math.max(1,Math.floor(Math.log(e)/Math.log(2)/7)+1),n=t(r),a=n.arrayBuffer,i=n.dataView,s=r-1,f=e,o=0;o<s;o+=1)i.setUint8(o,f>>7|128),f&=127;return i.setUint8(r-1,f),a},V=function(e){var r=t(8),n=r.arrayBuffer,a=r.dataView,i=[n],s=0;a.setUint32(0,1297379947);var f=!0,o=!1,u=void 0;try{for(var c,d=e[Symbol.iterator]();!(f=(c=d.next()).done);f=!0){var U=c.value,v=B(U.delta);try{var y=g(U);s+=v.byteLength+y.byteLength,i.push(v,y)}catch(t){if(t.message.match(/Unencodable\\smessage\\swith\\sa\\sdelta\\sof\\s[0-9]+\\./)){var h=e.indexOf(U);throw new Error("Unencodable message at index "+h+".")}throw t}}}catch(t){o=!0,u=t}finally{try{!f&&d.return&&d.return()}finally{if(o)throw u}}return a.setUint32(4,s),p(i)},b=function(t){var r=t.division,n=t.format,a=t.tracks,i=[];try{i.push(e(r,n,a))}catch(t){throw new Error("The given JSON object seems to be invalid.")}var s=!0,f=!1,o=void 0;try{for(var u,c=a[Symbol.iterator]();!(s=(u=c.next()).done);s=!0){var d=u.value;try{i.push(V(d))}catch(t){if(t.message.match(/Unencodable\\sevent\\sat\\sposition\\s[0-9]+\\./)){var U=a.indexOf(d);throw new Error(t.message.slice(0,-1)+" of the track at index "+U+".")}throw t}}}catch(t){f=!0,o=t}finally{try{!s&&c.return&&c.return()}finally{if(f)throw o}}return p(i)};addEventListener("message",function(t){var e=t.data;try{if("encode"!==e.method)throw new Error('The given method "'+e.method+'" is not supported');var r=e.id,n=e.params.midiFile,a=b(n);postMessage({error:null,id:r,result:{arrayBuffer:a}},[a])}catch(t){postMessage({error:{message:t.message},id:e.id,result:null})}})}();`;

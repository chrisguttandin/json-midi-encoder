// tslint:disable-next-line:max-line-length
export const worker = `!function(){"use strict";var a=function(a){var b=new ArrayBuffer(a);return{arrayBuffer:b,dataView:new DataView(b)}},b=function(b,c,d){var e=a(14),f=e.arrayBuffer,g=e.dataView;return g.setUint32(0,1297377380),g.setUint32(4,6),g.setUint16(8,c),g.setUint16(10,d.length),g.setUint16(12,b),f},c=function(a){var b=new ArrayBuffer(a);return{arrayBuffer:b,dataView:new DataView(b)}},d=function(a){var b=a.reduce(function(a,b){return a+b.byteLength},0);return a.reduce(function(a,b){var c=a[0],d=a[1];return d.set(new Uint8Array(b),c),[c+b.byteLength,d]},[0,new Uint8Array(b)])[1].buffer},e=function(a){for(var b=Math.max(1,Math.floor(Math.log(a)/Math.log(2)/7)+1),d=c(b),e=d.arrayBuffer,f=d.dataView,g=b-1,h=0;h<g;h+=1)f.setUint8(h,a>>7|128),a&=127;return f.setUint8(b-1,a),e},f=function(a){if("channelPrefix"in a){var b=c(4),f=b.arrayBuffer,g=b.dataView;return g.setUint8(0,255),g.setUint8(1,32),g.setUint8(2,1),g.setUint8(3,a.channelPrefix),f}if("controlChange"in a){var h=c(3),f=h.arrayBuffer,g=h.dataView;return g.setUint8(0,176|15&a.channel),g.setUint8(1,a.controlChange.type),g.setUint8(2,a.controlChange.value),f}if("endOfTrack"in a){var i=c(3),f=i.arrayBuffer,g=i.dataView;return g.setUint8(0,255),g.setUint8(1,47),g.setUint8(2,0),f}if("keySignature"in a){var j=c(5),f=j.arrayBuffer,g=j.dataView;return g.setUint8(0,255),g.setUint8(1,89),g.setUint8(2,2),g.setUint8(3,a.keySignature.key),g.setUint8(4,a.keySignature.scale),f}if("midiPort"in a){var k=c(4),f=k.arrayBuffer,g=k.dataView;return g.setUint8(0,255),g.setUint8(1,33),g.setUint8(2,1),g.setUint8(3,a.midiPort),f}if("noteOff"in a){var l=c(3),f=l.arrayBuffer,g=l.dataView;return g.setUint8(0,128|15&a.channel),g.setUint8(1,a.noteOff.noteNumber),g.setUint8(2,a.noteOff.velocity),f}if("noteOn"in a){var m=c(3),f=m.arrayBuffer,g=m.dataView;return g.setUint8(0,144|15&a.channel),g.setUint8(1,a.noteOn.noteNumber),g.setUint8(2,a.noteOn.velocity),f}if("pitchBend"in a){var n=c(3),f=n.arrayBuffer,g=n.dataView;return g.setUint8(0,224|15&a.channel),g.setUint8(1,127&a.pitchBend),g.setUint8(2,a.pitchBend>>7),f}if("programChange"in a){var o=c(2),f=o.arrayBuffer,g=o.dataView;return g.setUint8(0,192|15&a.channel),g.setUint8(1,a.programChange.programNumber),f}if("setTempo"in a){var p=c(6),f=p.arrayBuffer,g=p.dataView;return g.setUint8(0,255),g.setUint8(1,81),g.setUint8(2,3),g.setUint8(3,a.setTempo.microsecondsPerBeat>>16),g.setUint8(4,a.setTempo.microsecondsPerBeat>>8),g.setUint8(5,a.setTempo.microsecondsPerBeat),f}if("smpteOffset"in a){var q=c(8),f=q.arrayBuffer,g=q.dataView,r=void 0;return 24===a.smpteOffset.frameRate?r=0:25===a.smpteOffset.frameRate?r=32:29===a.smpteOffset.frameRate?r=64:30===a.smpteOffset.frameRate&&(r=96),g.setUint8(0,255),g.setUint8(1,84),g.setUint8(2,5),g.setUint8(3,a.smpteOffset.hour|r),g.setUint8(4,a.smpteOffset.minutes),g.setUint8(5,a.smpteOffset.seconds),g.setUint8(6,a.smpteOffset.frame),g.setUint8(7,a.smpteOffset.subFrame),f}if("sysex"in a){var s=c(1),f=s.arrayBuffer,g=s.dataView;g.setUint8(0,240);for(var t=a.sysex.length/2,u=e(t),v=c(t),w=v.arrayBuffer,x=v.dataView,y=0;y<a.sysex.length;y+=2)x.setUint8(y/2,parseInt(a.sysex.slice(y,y+2),16));return d([f,u,w])}if("timeSignature"in a){for(var z=c(7),f=z.arrayBuffer,g=z.dataView,A=a.timeSignature.denominator,B=0;A>1;)A/=2,B+=1;return g.setUint8(0,255),g.setUint8(1,88),g.setUint8(2,4),g.setUint8(3,a.timeSignature.numerator),g.setUint8(4,B),g.setUint8(5,a.timeSignature.metronome),g.setUint8(6,a.timeSignature.thirtyseconds),f}if("trackName"in a){var C=c(2),f=C.arrayBuffer,g=C.dataView;g.setUint8(0,255),g.setUint8(1,3);var D=new TextEncoder,E=D.encode(a.trackName).buffer,F=e(E.byteLength);return d([f,F,E])}throw new Error('Unencodable event with a delta of "'+a.delta+'".')},g=function(a){var b=a.reduce(function(a,b){return a+b.byteLength},0);return a.reduce(function(a,b){var c=a.offset,d=a.uint8Array;return d.set(new Uint8Array(b),c),{offset:c+b.byteLength,uint8Array:d}},{offset:0,uint8Array:new Uint8Array(b)}).uint8Array.buffer},h=function(b){for(var c=Math.max(1,Math.floor(Math.log(b)/Math.log(2)/7)+1),d=a(c),e=d.arrayBuffer,f=d.dataView,g=c-1,h=0;h<g;h+=1)f.setUint8(h,b>>7|128),b&=127;return f.setUint8(c-1,b),e},i=function(b){var c=a(8),d=c.arrayBuffer,e=c.dataView,i=[d],j=0;e.setUint32(0,1297379947);var k=!0,l=!1,m=void 0;try{for(var n,o=b[Symbol.iterator]();!(k=(n=o.next()).done);k=!0){var p=n.value,q=h(p.delta);try{var r=f(p);j+=q.byteLength+r.byteLength,i.push(q,r)}catch(a){if(a.message.match(/Unencodable\\smessage\\swith\\sa\\sdelta\\sof\\s[0-9]+\\./)){var s=b.indexOf(p);throw new Error("Unencodable message at index "+s+".")}throw a}}}catch(a){l=!0,m=a}finally{try{!k&&o.return&&o.return()}finally{if(l)throw m}}return e.setUint32(4,j),g(i)},j=function(a){var c=a.division,d=a.format,e=a.tracks,f=[];try{f.push(b(c,d,e))}catch(a){throw new Error("The given JSON object seems to be invalid.")}var h=!0,j=!1,k=void 0;try{for(var l,m=e[Symbol.iterator]();!(h=(l=m.next()).done);h=!0){var n=l.value;try{f.push(i(n))}catch(a){if(a.message.match(/Unencodable\\sevent\\sat\\sposition\\s[0-9]+\\./)){var o=e.indexOf(n);throw new Error(a.message.slice(0,-1)+" of the track at index "+o+".")}throw a}}}catch(a){j=!0,k=a}finally{try{!h&&m.return&&m.return()}finally{if(j)throw k}}return g(f)};addEventListener("message",function(a){var b=a.data.json;try{postMessage({midiFile:j(b)})}catch(a){postMessage({err:{message:a.message}})}})}();`;
